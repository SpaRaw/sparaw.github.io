<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gewichtete Entscheidungsmatrix — Kroatien Unterkünfte</title>
  <style>
    :root{
      --bg:#0f1720; /* dunkel */
      --card:#0b1216;
      --muted:#94a3b8;
      --accent:#0f766e; /* petrol */
      --accent-2:#14b8a6;
      --glass: rgba(255,255,255,0.03);
    }
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;color:#e6eef6;background:linear-gradient(180deg,var(--bg),#041018);}
    .app{max-width:1100px;margin:24px auto;padding:20px;display:grid;grid-template-columns:360px 1fr;gap:20px}
    .panel{background:var(--card);border-radius:12px;padding:16px;box-shadow:0 6px 18px rgba(2,6,23,0.6);}
    h1{margin:0 0 8px 0;font-size:20px}
    p.lead{color:var(--muted);margin-top:0;font-size:13px}
    .sliders{display:flex;flex-direction:column;gap:12px;margin-top:12px}
    .slider-row{display:flex;align-items:center;gap:12px}
    .slider-row label{width:120px;font-size:13px;color:var(--muted)}
    input[type=range]{-webkit-appearance:none;height:6px;background:var(--glass);border-radius:999px;flex:1}
    input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:18px;height:18px;border-radius:50%;background:var(--accent);box-shadow:0 2px 6px rgba(15,118,110,0.5)}
    .val{width:36px;text-align:right;color:var(--accent-2);font-weight:600}
    .controls{display:flex;gap:10px;align-items:center;margin-top:12px}
    .checkbox{display:flex;align-items:center;gap:8px;color:var(--muted)}
    .list{padding:12px;display:grid;grid-template-rows:auto 1fr;gap:12px}
    .ranking{display:flex;gap:12px;align-items:center}
    .prop-card{display:flex;flex-direction:column;gap:6px;padding:10px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));}
    .prop-row{display:flex;justify-content:space-between;align-items:center}
    .prop-title{font-weight:700}
    .score-badge{background:var(--accent);color:white;padding:6px 10px;border-radius:999px;font-weight:700}
    .bar{height:10px;background:rgba(255,255,255,0.06);border-radius:999px;overflow:hidden}
    .bar > i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),var(--accent-2));}
    .details{font-size:13px;color:var(--muted);display:flex;gap:8px;flex-wrap:wrap}
    .pill{background:rgba(255,255,255,0.02);padding:6px 8px;border-radius:999px}
    .top-header{display:flex;justify-content:space-between;align-items:center}
    .full-list{max-height:620px;overflow:auto;padding-right:6px}
    footer{color:var(--muted);font-size:12px;margin-top:12px}
    .btn{background:var(--accent);color:#fff;padding:8px 12px;border-radius:8px;border:none;cursor:pointer}
    .small{font-size:12px;padding:6px 8px}
    /* responsive */
    @media (max-width:980px){.app{grid-template-columns:1fr;max-width:720px;margin:10px}} 
  </style>
</head>
<body>
  <div class="app">
    <div class="panel">
      <div class="top-header">
        <div>
          <h1>Gewichtete Entscheidungsmatrix</h1>
          <p class="lead">Ziehe die Slider, um Kriterien zu gewichten — das Ranking aktualisiert sich in Echtzeit. (Beispieldaten; Preise sind Schätzungen — bitte Booking prüfen)</p>
        </div>
        <div style="text-align:right">
          <div style="font-size:12px;color:var(--muted)">Budget-Max (€):</div>
          <div style="font-weight:700;color:var(--accent-2);">€ <span id="budgetVal">95</span></div>
        </div>
      </div>

      <div class="sliders" id="sliders">
        <!-- sliders injected -->
      </div>

      <div class="controls">
        <label class="checkbox"><input type="checkbox" id="filterBudget" checked> Nur innerhalb Budget</label>
        <button class="btn small" id="resetBtn">Reset Gewichte</button>
      </div>

      <footer>Tip: Wähle hohe Gewichtung für das, was euch am wichtigsten ist (z. B. Strandnähe oder Preis). Klicke eine Unterkunft an, um Details zu sehen.</footer>
    </div>

    <div class="panel list">
      <div class="ranking">
        <div>
          <h2 style="margin:0">Ranking</h2>
          <div style="color:var(--muted);font-size:13px">Aktualisiert in Echtzeit</div>
        </div>
        <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
          <div style="color:var(--muted);font-size:13px">Top</div>
          <div class="pill">5</div>
        </div>
      </div>

      <div class="full-list" id="results">
        <!-- results injected -->
      </div>
    </div>
  </div>

  <script>
    // --- Beispiel-Daten (vereinfachte Scores / Schätzpreise) ---
    const properties = [
      {id:1,name:'Beachfront Apartment – Slatine (Čiovo)', price:120, beach:10, rating:10, clean:10, parking:10, sightseeing:8, indoor:6, bedrooms:3, note:'Direkt am Strand, exzellente Bewertungen (10).' },
      {id:2,name:'2BR Nice Apartment – Prigradica (Korčula)', price:88, beach:9, rating:9.8, clean:9.5, parking:9, sightseeing:7, indoor:6, bedrooms:2, note:'Sehr beliebt, kurze Wege zum Strand.'},
      {id:3,name:'Apartment with Sea View – Prigradica', price:92, beach:8.5, rating:9.6, clean:9, parking:8, sightseeing:7.5, indoor:6.5, bedrooms:2, note:'Meerblick, sehr gepflegt.'},
      {id:4,name:'Apartment Borovina‑2 (Korčula)', price:110, beach:10, rating:9.8, clean:9.7, parking:8.5, sightseeing:7.8, indoor:5.5, bedrooms:2, note:'Direkt am Strand, Interhome-Standard.'},
      {id:5,name:'Apartment GALA – Korčula', price:95, beach:8, rating:9.1, clean:9.2, parking:8, sightseeing:8.2, indoor:7, bedrooms:2, note:'Ruhig, Garten & Grill.'},
      {id:6,name:'Apartments Gugic – Prigradica', price:85, beach:10, rating:9.3, clean:9.4, parking:9, sightseeing:7.5, indoor:6.5, bedrooms:2, note:'Sehr nah am Strand Vanesa.'},
      {id:7,name:'Luxury Beach Apt – Šibenik', price:105, beach:10, rating:9.2, clean:9.1, parking:8.5, sightseeing:9, indoor:7.5, bedrooms:2, note:'Direkt, ruhig, privatstrand.'},
      {id:8,name:'Two Bedroom Apartment – Split', price:98, beach:7, rating:8.8, clean:8.7, parking:7.5, sightseeing:10, indoor:8.5, bedrooms:2, note:'Stadt & Strand, ideal für Sightseeing.'},
      {id:9,name:'2BR – Crikvenica (Sea View)', price:82, beach:9, rating:8.6, clean:8.8, parking:8, sightseeing:7.5, indoor:7.8, bedrooms:2, note:'Familienfreundlich, Strand ~400m.'},
      {id:10,name:'2BR Apt – North Coast (Crikvenica)', price:76, beach:8.5, rating:8.5, clean:8.6, parking:8.2, sightseeing:7.2, indoor:8.0, bedrooms:2, note:'Gutes Preis-Leistungs-Verhältnis.'},
      {id:11,name:'Exceptional 2BR – Pula', price:89, beach:8.8, rating:9.7, clean:9.3, parking:7.5, sightseeing:9.5, indoor:8.2, bedrooms:2, note:'Nähe Kultur & Museen (Pula).'},
      {id:12,name:'Apartments Kristic Rakovica (Plitvice)', price:70, beach:0, rating:8.2, clean:8.3, parking:9, sightseeing:10, indoor:7, bedrooms:2, note:'Nähe Plitvicer Seen (kein Strand).'},
      {id:13,name:'Apartments Puntamika – Zadar', price:83, beach:9, rating:8.7, clean:8.8, parking:8, sightseeing:8.8, indoor:7.2, bedrooms:2, note:'Gute Strandlage & Altstadtzugang.'},
      {id:14,name:'Apartmani Trogir', price:65, beach:6.5, rating:8.2, clean:8.1, parking:7.8, sightseeing:9.2, indoor:6.8, bedrooms:2, note:'Historische Altstadt, günstiger Preis.'},
      {id:15,name:'Apartment Borovina (weitere Einheit)', price:99, beach:10, rating:9.6, clean:9.0, parking:8.5, sightseeing:7.8, indoor:6.0, bedrooms:2, note:'Ähnliche Lage, Interhome.'}
    ];

    const criteria = [
      {key:'price', label:'Preis (niedriger ist besser)', default:25},
      {key:'beach', label:'Strandnähe', default:20},
      {key:'rating', label:'Bewertung', default:20},
      {key:'clean', label:'Sauberkeit', default:10},
      {key:'parking', label:'Parken', default:5},
      {key:'sightseeing', label:'Sightseeing‑Access', default:10},
      {key:'indoor', label:'Schlechtwetter‑Optionen', default:10}
    ];

    // Build sliders
    const slidersEl = document.getElementById('sliders');
    const sliderState = {};
    criteria.forEach(c=>{
      const row = document.createElement('div'); row.className='slider-row';
      const label = document.createElement('label'); label.textContent=c.label; label.htmlFor=c.key;
      const input = document.createElement('input'); input.type='range'; input.min=0; input.max=100; input.value=c.default; input.id=c.key;
      const val = document.createElement('div'); val.className='val'; val.id=c.key+'Val'; val.textContent=c.default;
      input.addEventListener('input',()=>{ document.getElementById(c.key+'Val').textContent=input.value; sliderState[c.key]=Number(input.value); computeAndRender(); });
      row.appendChild(label); row.appendChild(input); row.appendChild(val);
      slidersEl.appendChild(row);
      sliderState[c.key]=c.default;
    });

    // budget control
    const budgetEl = document.getElementById('budgetVal');
    let budget = 95;
    function updateBudget(val){budget = val; budgetEl.textContent = val; computeAndRender();}
    // small slider added as ctrl: Ctrl+Up/Down to change budget? Simpler: click budget to prompt
    budgetEl.parentElement.addEventListener('click',()=>{
      const v = prompt('Max Budget pro Nacht (in €)', budget);
      const n = Number(v);
      if(!isNaN(n) && n>0){ updateBudget(Math.round(n)); }
    });

    // filter checkbox
    const filterCheckbox = document.getElementById('filterBudget');
    filterCheckbox.addEventListener('change',computeAndRender);

    document.getElementById('resetBtn').addEventListener('click',()=>{
      criteria.forEach(c=>{document.getElementById(c.key).value = c.default; document.getElementById(c.key+'Val').textContent=c.default; sliderState[c.key]=c.default;});
      updateBudget(95);
      filterCheckbox.checked = true;
      computeAndRender();
    });

    // normalization helpers
    function normalizeScores(props){
      const prices = props.map(p=>p.price);
      const minP = Math.min(...prices), maxP=Math.max(...prices);
      return props.map(p=>{
        // priceScore: inverted 0..10
        const priceScore = (maxP===minP)?10: (1 - (p.price - minP)/(maxP-minP)) * 10;
        return Object.assign({},p,{_norm:{price:priceScore, beach:p.beach, rating:p.rating, clean:p.clean, parking:p.parking, sightseeing:p.sightseeing, indoor:p.indoor}});
      });
    }

    function computeScore(p, weights){
      // weights expected 0..100, convert to sum=1
      const sum = Object.values(weights).reduce((a,b)=>a+b,0) || 1;
      const w = {};
      for(const k in weights) w[k]=weights[k]/sum;
      // criteria keys: price, beach, rating, clean, parking, sightseeing, indoor
      const s = p._norm.price * w.price + p._norm.beach * w.beach + p._norm.rating * w.rating + p._norm.clean * w.clean + p._norm.parking * w.parking + p._norm.sightseeing * w.sightseeing + p._norm.indoor * w.indoor;
      return s; // 0..10
    }

    // render
    const resultsEl = document.getElementById('results');

    function computeAndRender(){
      // get current weights
      const weights = {};
      criteria.forEach(c=>weights[c.key]=Number(document.getElementById(c.key).value));
      const filtered = properties.filter(p=>!(filterCheckbox.checked && p.price>budget));
      const normalized = normalizeScores(properties);
      // attach normalized by id
      const normMap = {};
      normalized.forEach(n=>normMap[n.id]=n);
      // compute scores for either filtered set but normalization stays on full set
      const scored = properties.map(p=>{
        const pn = normMap[p.id];
        const score = computeScore(pn,weights);
        return {...pn,score};
      }).filter(p=>!filterCheckbox.checked || p.price<=budget);

      scored.sort((a,b)=>b.score - a.score);

      // render top 5 as compact and rest simple
      resultsEl.innerHTML = '';
      scored.forEach((p,idx)=>{
        const card = document.createElement('div'); card.className='prop-card';
        const row = document.createElement('div'); row.className='prop-row';
        const title = document.createElement('div'); title.innerHTML = `<div class="prop-title">${idx+1}. ${p.name}</div><div class="details" style="margin-top:6px">`;
        const right = document.createElement('div'); right.style.textAlign='right';
        const scoreBadge = document.createElement('div'); scoreBadge.className='score-badge'; scoreBadge.textContent = p.score.toFixed(2);
        right.appendChild(scoreBadge);
        // meta
        const meta = document.createElement('div'); meta.className='details';
        meta.innerHTML = `<span class="pill">Preis: €${p.price}</span><span class="pill">Bewertung: ${p.rating}</span><span class="pill">Strand: ${p.beach}</span><span class="pill">Schlafzimmer: ${p.bedrooms}</span>`;

        // bar
        const bar = document.createElement('div'); bar.className='bar'; const inner = document.createElement('i'); inner.style.width = Math.max(4, (p.score/10)*100) + '%'; bar.appendChild(inner);

        // details toggle
        const note = document.createElement('div'); note.style.color='var(--muted)'; note.style.marginTop='6px'; note.textContent = p.note;

        row.appendChild(title); row.appendChild(right);
        card.appendChild(row);
        card.appendChild(meta);
        card.appendChild(bar);
        card.appendChild(note);

        // click to show full breakdown
        card.style.cursor='pointer';
        card.addEventListener('click',()=>{
          alert(`${p.name}\n\nPreis: €${p.price}\nStrand: ${p.beach}/10\nBewertung: ${p.rating}/10\nSauberkeit: ${p.clean}/10\nParken: ${p.parking}/10\nSightseeing: ${p.sightseeing}/10\nIndoor: ${p.indoor}/10\n\nGesamtpunktzahl: ${p.score.toFixed(2)}\n\nHinweis: Preise sind Schätzwerte. Bitte Verfügbarkeit & Preis auf Booking prüfen.`);
        });

        resultsEl.appendChild(card);
      });

      if(scored.length===0){ resultsEl.innerHTML = '<div style="color:var(--muted);padding:12px">Keine Unterkunft innerhalb des Budgets gefunden. Entferne den Filter oder erhöhe das Budget.</div>'; }
    }

    // initial render
    computeAndRender();

    // small UX: keyboard +/- to adjust budget
    window.addEventListener('keydown', (e)=>{
      if(e.key === '+' || e.key === '='){ updateBudget(budget+5); }
      if(e.key === '-' ){ updateBudget(Math.max(10,budget-5)); }
    });

  </script>
</body>
</html>
